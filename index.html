 // Handle search form submission
        searchForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (!isAuthenticated) {
                showLoginModal();
                return;
            }
            
            const type = searchType.value;
            const value = searchValue.value.trim();
            
            if (!value) {
                alert('กรุณาระบุข้อมูลที่ต้องการค้นหา');
                return;
            }
            
            // Create request object
            const request = {
                method: 'POST',
                url: 'https://debtor.led.go.th/service/getBankrupt.php',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Basic ${btoa(authCredentials.username + ':' + authCredentials.password)}`
                },
                body: {
                    search_type: type,
                    search_value: value
                }
            };
            
            // Display request (hide sensitive info)
            const displayRequest = {...request};
            displayRequest.headers.Authorization = 'Basic ********';
            requestData.textContent = JSON.stringify(displayRequest, null, 2);
            
            // Simulate API call
            setTimeout(() => {
                let response;
                let results = [];
                
                // Check if we have matching data in our sample data
                if (sampleData[type] && sampleData[type][value]) {
                    results = sampleData[type][value];
                    response = {
                        status: 200,
                        message: 'Success',
                        data: results
                    };
                } else {
                    // Try partial match for demonstration
                    if (type === 'name') {
                        for (const key in sampleData[type]) {
                            if (key.includes(value) || value.includes(key)) {
                                results = results.concat(sampleData[type][key]);
                            }
                        }
                    }
                    
                    if (results.length > 0) {
                        response = {
                            status: 200,
                            message: 'Success',
                            data: results
                        };
                    } else {
                        response = {
                            status: 404,
                            message: 'No data found',
                            data: []
                        };
                    }
                }
                
                // Display response
                responseData.textContent = JSON.stringify(response, null, 2);
                
                // Update results table
                updateResults(response.data);
            }, 1000);
        });
        
        // Update results table
        function updateResults(data) {
            resultsTable.innerHTML = '';
            
            if (data.length > 0) {
                data.forEach(item => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="py-2 px-4 border-b">${item.id_card}</td>
                        <td class="py-2 px-4 border-b">${item.name}</td>
                        <td class="py-2 px-4 border-b">${item.case_number}</td>
                        <td class="py-2 px-4 border-b">${item.court}</td>
                        <td class="py-2 px-4 border-b">${item.order_date}</td>
                        <td class="py-2 px-4 border-b">
                            <span class="px-2 py-1 rounded-full text-xs ${getStatusClass(item.status)}">
                                ${item.status}
                            </span>
                        </td>
                        <td class="py-2 px-4 border-b">
                            <button class="text-blue-600 hover:text-blue-800 mr-2 view-details" data-case="${item.case_number}">ดูรายละเอียด</button>
                            <button class="text-green-600 hover:text-green-800 export-case" data-case="${item.case_number}">ส่งออก</button>
                        </td>
                    `;
                    resultsTable.appendChild(row);
                });
                
                resultsContainer.classList.remove('hidden');
                noResultsMessage.classList.add('hidden');
                
                // Add event listeners to view details buttons
                document.querySelectorAll('.view-details').forEach(button => {
                    button.addEventListener('click', function() {
                        const caseNumber = this.getAttribute('data-case');
                        alert(`แสดงรายละเอียดของคดี: ${caseNumber}`);
                    });
                });
                
                // Add event listeners to export buttons
                document.querySelectorAll('.export-case').forEach(button => {
                    button.addEventListener('click', function() {
                        const caseNumber = this.getAttribute('data-case');
                        alert(`ส่งออกข้อมูลคดี: ${caseNumber}`);
                    });
                });
            } else {
                resultsContainer.classList.add('hidden');
                noResultsMessage.classList.remove('hidden');
            }
        }
        
        // Get status class for styling
        function getStatusClass(status) {
            switch(status) {
                case 'อยู่ระหว่างกระบวนการล้มละลาย':
                    return 'bg-yellow-100 text-yellow-800';
                case 'ล้มละลาย':
                    return 'bg-red-100 text-red-800';
                case 'ปลดจากล้มละลาย':
                    return 'bg-green-100 text-green-800';
                default:
                    return 'bg-gray-100 text-gray-800';
            }
        }
        
        // Clear button
        clearBtn.addEventListener('click', function() {
            searchValue.value = '';
            requestData.textContent = '// คำขอ API จะแสดงที่นี่';
            responseData.textContent = '// ผลลัพธ์ API จะแสดงที่นี่';
            resultsContainer.classList.add('hidden');
            noResultsMessage.classList.add('hidden');
        });
        
        // Export button
        exportBtn.addEventListener('click', function() {
            if (resultsContainer.classList.contains('hidden')) {
                alert('ไม่มีข้อมูลที่จะส่งออก');
                return;
            }
            
            alert('กำลังส่งออกข้อมูลทั้งหมด');
        });

        // Initialize authentication check
        checkAuthentication();
    });
</script>
